[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=ded08103-7c1e-4a70-8d48-591ef799d4b2
Description=副本v2
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]
1.图片资源是否移动
2.

[UIPackage]
UEsDBBQAAgAIAOKZPVWk64O3mgcAAAhgAAAJABEAVUlQYWNrYWdlVVQNAAfV7jVj1e41Y9XuNWPtXElzVFUU/johkISYSQiBAAZImIcwo8xhkEAYu5kiIJ3QQKDTid0JBP+J5Ypi47CRKi03uHJhSVmFJVXqUi1cubKKYifxnDfQt2NSvnPvTd9qzaEOtwl93/fucM493znvpRy+fP+k4Zf7Dxf8inGyB+V4OVaFmcrPYoF6Ug+UBf9+OTY2Fv54bFpKSv4inRGsIa91Beks0irSStJq0tdIZ5PWkNb6S4860gbS10kbSeeQNpHOJZ1HOp+0mXQB6SLSFtKFpItJW0nfIF1Cuox0KWkb6XLSdtIVpKtIV5KuJl1LuoZ0XXCf64N2WszlDAbpzzCtySFkqM3iHiTSRDsmvFbsX77b8cEPj58//TlWjmAzkJxFFzqgL5WIxUL8eZN8pzXr44b46v8dQALdBndQreBXaOAnaL6HkMIJJDFArVQaUebhNwS+N2q/GUHLdjStpaumcngwO2BgfuD+Gw36x2Ampv1N5fPPvvvdZPwCk52S/rp+J+//ygpivqhrFvpKPnWS6EVa8x5qyf/NDuKUqPhliv87h37kSHXvoF5j/OUK/hlCTeIaTtI8pIVnb+j/a4JrRsWfoeAnCH+Uzn2D9Y9Jx1+hrP8Bij7SpFnNO5mjgT9TGX8ev5PWoQ+35fhevFwnmP9Z49a/z3D+OT6vFOBXwo/hVblMRvECpSezHOO/mHjOvWPpeLw1nszkWuOpbP/1KcJv//SKUf8e8jxZ8j8p+ltH2P/ODWwq6v6rUvZ/N9me3OoK9399cL2o+NUT2n+c7uMmzYPsNGwm+w85cFT82Qr+for+h7wzIEuaoXuQnUJNNP4q+Lw8Kn6Ngn+Yxp4x8z/i84/91a5X40/T6XuD7oHnPaPj/8X4tQXrn6T5H6Z74Hno9NYhPAnye2NyWUnz34R83isKfp2C3+ld37e/KHgT7L/YHCF+vYJv6j9M409T6e7PDXcOjpr21w7hS52/JGjnD3uxr87u8/yP2P4alP13ivBHCT1NUbiO1GrgN47D5/hrhMatk4Vp1sBX8+V+/kmfQXL+ifnMPvi51okkzDtNVf5phdD/8HkZxm0u+Cf7y8rgsw3+2Qo/nx0Vfy6s8s/YEuH8N8Eu/2yBn+uPij8P9vnncgF+of0Vn382wy7/5FR6m2D88xV8UzE9/9kPcF2nh5zYc43+rs/Pcsf4pvzTRv6B63eLBPtvAfL5Bwv8U+z/W2CXf7YHNhUVfyGs8s8Y10lXCfAXwS7/5JruMgH+Yrjln3xWh/yzi7B5znOa+DUa+K3Ixx9xL/b1bTBFdiCVRg38Jcr8x1CRJgqkHYCOGR4Apvxz9Rc3jfp3ZYZGTAhk2F93Al3zRwv5B/H+W/oP/zdCFpgpGv6yAnzmX5sM/E++/r9uku9MNf9i7DcFttim+B8X/IvPy6rgsw3+tZnaTYLxL4dd/rWF2rcE+Ctgl3/x81BrBPgrYS/+f/Tnk2c/PX388NGzBx99/ceDj1FkMeUfO+Dngz8M9qVUyuBWTPmHi/rvKuTjfwv8W+x/VsMu/95A7XaB/a2B3frvVmo7BPhr4ZZ/rYNd/rUjGFNU/PWwW//bDZ9PRMXfALv8aye12wT4HbDn/13Xv12La/7Scj9h1N8F/94It/XfTVDrP0mK/3K4G/Agqejw780K/nHiPmmv/txNmhHHoJx/5vncK7D/LQr+CW/cAzQLae36s3T8WxX8I4R3R5t9+v5vD2T1j20ozD/10Rrkilj/3K7g86mT9ZDTwdMHU7//d8Ce/7eVP9Fl4KVef//yx69+c8eewvzHZu3+1TSDHE+f8641sRQj/3FS4P84V+Iy/8G5Apv5jy6wH40+/p2wm/84Cj5Ho+Pvgt38x0FwHBEdfzfcPv+8B37Owbe/4vPfvbDLfw+B45jo878PdvnvMfA5Hh1/P9zy307Y5b8ngmtGxT+g4Jvmz74N9vLamF7+zHX9vNTr96ZiI/8R9+w4+v47CLv5j9OeHUXHPwS39Wf2VS7579twy3+PwC7/5fGcFax/F9zy36Owy38TkPHfY7DH/0yl1PNnptKd7E2lTfsbvIDqIv/RDbf5j+MYX//foj1/Yf2fd+HFSb5TDP6bEvg/jhcrXn0uPv9lrh7+Xhkb/Pddaq8Ixn8KdvnvVWpvCPBPwy7/7aH2vAD/DNTnv8zEdf7Mf/5Av7/r95/4XQh+H4Zzwks1+pue4y7yH3HF/l08f5+A3fzHO9T2CezvLOzmP5LUXhLgn4Pb/Md52M1/MGu5IBj/Bdh9/ppxrwvwL8Iu/71Mba8Avwf24v//e/7EtZjyBxf5D/aXLvMfl6Dm/327y5EVJr13QGX3oPP88eUC+x8hvEHyPv14Xy/+F+NfwXj+s9Vg/WOv8Cfz4sXgP3cF/o/5gkv+cxV2+c971A4Jxp9U1t/zH/qPv/8n6u8m/V3zh0/gc4hv4L/XIBUb/Jcjx3uC/dcLu/yXz79+AX4f3NZ/r2Gi+LN4/CcFu/yHf4HgiGD+r8Mu/+F39zIC/Btwy39uwi7/uUPtLcH4+xX8CriVaf7gVmzx31HB/rsFu/x3kNphAf5tuK3/8nnlkv8MwC3/ycAt/xmE3fqnFN+2mOD/DVBLAQIXCxQAAgAIAOKZPVWk64O3mgcAAAhgAAAJAAkAAAAAAAAAAAAAgAAAAABVSVBhY2thZ2VVVAUAB9XuNWNQSwUGAAAAAAEAAQBAAAAA0gcAAAAA


[Script]
/**
每过3分钟 进行一次仓库分解
仓库分解时间为30秒每次
**/
Delay 1000
//捡箱子默认时间
Form1.InputBox1.Text = 180
//分解默认时间
Form1.InputBox2.Text = 25
缩小窗口
//初始时间记录
Dim times
times = 毫秒级时间戳
//当前的类型   1=捡宝箱  2=分解仓库(30秒)
Dim currType
currType = 2
//是否已经Log了 0=未Log 1=Log完成
Dim isLog
isLog = 0
//宠物相关 
//1=第一个宠物 2 3 4
Dim petType
petType = 1
//宠物在线时长 5分钟一召唤
Dim petTime
petTime = 毫秒级时间戳
// 宠物是否运行 0未运行 1已运行
Dim petRun
petRun = 0
// 平A地板时间
Dim ATime
ATime = 毫秒级时间戳
//颜色
Dim colorName
Dim colorTime
colorName = ""
colorTime = 毫秒级时间戳
While True
    If  currType = 1 Then 
        分解装备 
    End If
    If  currType = 2 Then 
        捡箱子 
    End If
    // 开始分解
    If  currType = 1 And 毫秒级时间戳 - times > Form1.InputBox2.Text * 1000  Then 
        currType = 2
        times = 毫秒级时间戳
        isLog = 0
    End If
    // 开始捡箱子
    If  currType = 2 And 毫秒级时间戳 - times > Form1.InputBox1.Text * 1000  Then 
        currType = 1
        times = 毫秒级时间戳
        isLog = 0
    End If
    // 宠物召唤
    // 宠物召唤 
    平A加速
    //平A 
    //5分钟未移动判断 
    // 被沙斯截图
    Kill
    未移动判断 
    // 清理Log队列
    If  getListCount >20  Then 
        clearList
    End If
Wend
installList(getListCount)
//队首 插入
Function installList(text)
    Form1.ListBox1.InsertItem text,0 
End Function
//清理队列
Function clearList()
    Form1.ListBox1.List = "清理队列完成"
End Function
//队列长度 
Function getListCount()
    getListCount=  Form1.ListBox1.ListCount
End Function
Function 毫秒级时间戳()
    毫秒级时间戳=    (DateDiff("s","1970/1/1 00:00:00",Now())*1000)+(Round((timer() - Int(timer()))*1000,0))-T1
End Function
Function 时间戳转时间(时间戳)
    时间戳转时间=    DateAdd("s",时间戳,"1970/01/01 00:00:00")
End Function
Function 缩小窗口
    Hwnd = Plugin.Window.Find("COSCLIENT", "英魂之刃")//获取窗口句柄
    Call Plugin.Window.Move(Hwnd, 0, 0)//将句柄Hwnd的窗口移动到x,y
    Plugin.Window.SetClientSize Hwnd, 1200, 750//将句柄为Hwnd的窗口拉伸x,y
End Function
Function 捡箱子
    // 写入Log
    If isLog = 0 Then 
        重启挂机
        closeWindow
        installList ("捡箱子：" & Time)
        //关闭背包
        MoveTo 828, 135
        LeftClick 1
        Delay 500
    End If
    isLog = 1
    FindColorEx 219,129,937,618 ,"2CB1BB",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"7B625D",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"2B3E6C",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                KeyPress "W",1
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
    FindColorEx 219,129,937,618 ,"286D78",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"6E5C55",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"323E5A",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                KeyPress "W",1
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
    FindColorEx 219,129,937,618 ,"2A7C89",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"6D5C55",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"313C62",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                KeyPress "W",1
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
End Function
Function 重启挂机
    installList ("重启挂机程序：" & Time)
    Delay 5000
    MoveTo 1141, 128
    LeftClick 1
    Delay 1000
    MoveTo 596,468
    LeftClick 1
    Delay 1000
    LeftClick 1
    Delay 1500
End Function
Function 分解装备
    // 写入Log
    If isLog = 0 Then 
        重启挂机 
        closeWindow
        installList ("分解装备：		" & Time)
        installList ("打开背包：		" & Time)
        FindPic 642,602,882,739,"C:\yhzr\背包.bmp",0.9,intX,intY
        If intX > 0 And intY > 0 Then 
            MoveTo intX, intY
            LeftClick 1
        End If
        Delay 1000
    End If
    isLog = 1
    FindPic 355,183,834,544,"C:\yhzr\蓝项链.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\蓝铠甲.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\蓝匕首.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If   
    FindPic 355,183,834,544,"C:\yhzr\蓝靴子.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    //
    FindPic 355,183,834,544,"C:\yhzr\紫项链.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\紫铠甲.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\紫匕首.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\紫靴子.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    //
    FindPic 355,183,834,544,"C:\yhzr\白靴子.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\白匕首.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\白铠甲.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\白项链.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    //
    FindPic 355,183,834,544,"C:\yhzr\金项链.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\金铠甲.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\金匕首.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If   
    FindPic 355,183,834,544,"C:\yhzr\金靴子.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
        //
    FindPic 355,183,834,544,"C:\yhzr\药1.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If
    FindPic 355,183,834,544,"C:\yhzr\药2.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If
    FindPic 355,183,834,544,"C:\yhzr\药3.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If   
    FindPic 355,183,834,544,"C:\yhzr\药4.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If
End Function
Function 分解(intX,intY,isClick)
    MoveTo intX+5, intY+5
    RightClick 1
    Delay 200
    MoveTo intX+7, intY+7
    LeftClick 1
    installList "分解成功：" & intX & "," & intY
    If isClick = 1 Then 
    	 MoveTo 595, 426
   		LeftClick 1
    End If
    Delay 1000
End Function
Function 宠物召唤
    If  petType = 1 And petRun = 0 Then 
        召唤点击 30, 681
    End If
    If  petType = 2 And petRun = 0 Then 
        召唤点击 56,676
    End If
    If  petType = 3 And petRun = 0 Then 
        召唤点击 25,712
    End If
    If  petType = 4 And petRun = 0 Then 
        召唤点击 55,715
    End If
    // 五分钟一召唤
    If 毫秒级时间戳 - petTime > 5 * 60 * 1000 Then 
        If  petType = 4 Then 
            petType = 1
        Else 
            petType = petType + 1
        End If
        petTime = 毫秒级时间戳
        petRun = 0
    End If
End Function
Function 召唤点击(x, y)
    MoveTo x,y
    LeftClick 2
    Delay 100
    petRun = 1
    installList "宠物召唤："& petType
End Function
//平A辅助
Function 平A 
    If 毫秒级时间戳 - ATime > 5000 Then 
        ATime = 毫秒级时间戳
        MoveTo 604, 347
        KeyPress "A", 1
        Delay 10
        LeftClick 1
        //installList "平A辅助"
    End If
End Function
//5分钟 未移动判断
Function 未移动判断
    GetColor = GetPixelColor(158, 128)
    If 毫秒级时间戳 - colorTime > 5 * 60 * 1000 Then 
        installList "当前颜色：" &GetPixelColor(158, 128)
        colorTime = 毫秒级时间戳
        If colorName =  GetColor Then 
            MoveTo 1114, 36
            RightClick 2
            installList "5分钟 未移动，开始移动"
            Delay 10000               
            colorName =  GetColor
        End If	
    End If
End Function
//死亡截图
Function Kill
    FindPic 260,107,1008,651,"C:\yhzr\kill.bmp",0.7,intX,intY
    If intX > 0 And intY > 0 Then 
        Call Lib.图像.无限屏幕截图(0,0,1366,768,"C:\英魂之刃kill\","bmp")
    End If
End Function
//关闭窗体
Function closeWindow
    installList ("关闭窗口：" & Time)
    //好友申请
    MoveTo 774, 245
    LeftClick 1
    Delay 200
    //分解失败
    MoveTo 729,315
    LeftClick 1
End Function
