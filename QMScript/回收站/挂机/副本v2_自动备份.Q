[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=0aefa834-2d78-4183-a866-398378a2a0c0
Description=副本v2_自动备份
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]
1.图片资源是否移动
2.

[UIPackage]
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


[Script]
/**
每过3分钟 进行一次仓库分解
仓库分解时间为30秒每次
**/
Delay 1000
//捡箱子默认时间
Form1.InputBox1.Text = 40
//分解默认时间
Form1.InputBox2.Text = 20
缩小窗口
//初始时间记录
Dim times
times = 毫秒级时间戳
//当前的类型   1=捡宝箱  2=分解仓库(30秒)
Dim currType
currType = 2
//是否已经Log了 0=未Log 1=Log完成
Dim isLog
isLog = 0
//宠物相关 
//1=第一个宠物 2 3 4
Dim petType
petType = 1
//宠物在线时长 5分钟一召唤
Dim petTime
petTime = 毫秒级时间戳
// 宠物是否运行 0未运行 1已运行
Dim petRun
petRun = 0
// 平A地板时间
Dim ATime
ATime = 毫秒级时间戳
//颜色
Dim colorName
Dim colorTime
colorName = ""
colorTime = 毫秒级时间戳
While True
    If  currType = 1 Then 
        分解装备 
    End If
    If  currType = 2 Then 
        捡箱子 
    End If
    // 开始分解
    If  currType = 1 And 毫秒级时间戳 - times > Form1.InputBox2.Text * 1000  Then 
        currType = 2
        times = 毫秒级时间戳
        isLog = 0
    End If
    // 开始捡箱子
    If  currType = 2 And 毫秒级时间戳 - times > Form1.InputBox1.Text * 1000  Then 
        currType = 1
        times = 毫秒级时间戳
        isLog = 0
    End If
    // 宠物召唤
    // 宠物召唤 
    平A加速
    //平A 
    //5分钟未移动判断 
    // 被沙斯截图
    Kill
    未移动判断 
    // 清理Log队列
    If  getListCount >20  Then 
        clearList
    End If
Wend
installList(getListCount)
//队首 插入
Function installList(text)
    Form1.ListBox1.InsertItem text,0 
End Function
//清理队列
Function clearList()
    Form1.ListBox1.List = "清理队列完成"
End Function
//队列长度 
Function getListCount()
    getListCount=  Form1.ListBox1.ListCount
End Function
Function 毫秒级时间戳()
    毫秒级时间戳=    (DateDiff("s","1970/1/1 00:00:00",Now())*1000)+(Round((timer() - Int(timer()))*1000,0))-T1
End Function
Function 时间戳转时间(时间戳)
    时间戳转时间=    DateAdd("s",时间戳,"1970/01/01 00:00:00")
End Function
Function 缩小窗口
    Hwnd = Plugin.Window.Find("COSCLIENT", "英魂之刃")//获取窗口句柄
    Call Plugin.Window.Move(Hwnd, 0, 0)//将句柄Hwnd的窗口移动到x,y
    Plugin.Window.SetClientSize Hwnd, 1200, 750//将句柄为Hwnd的窗口拉伸x,y
End Function
Function 捡箱子
    // 写入Log
    If isLog = 0 Then 
        closeWindow
        installList ("捡箱子：" & Time)
        //关闭背包
        MoveTo 830,136
        LeftClick 1
        Delay 500
        重启挂机
    End If
    isLog = 1
    FindColorEx 219,129,937,618 ,"2CB1BB",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"7B625D",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"2B3E6C",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                KeyPress "W",1
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
    FindColorEx 219,129,937,618 ,"286D78",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"6E5C55",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"323E5A",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                KeyPress "W",1
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
    FindColorEx 219,129,937,618 ,"2A7C89",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"6D5C55",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"313C62",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                KeyPress "W",1
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
End Function
Function 重启挂机
    installList ("重启挂机程序：" & Time)
    Delay 1500
    MoveTo 1109,191
    LeftClick 1
    Delay 2000
    MoveTo 589,514
    LeftClick 1
    Delay 1000
    LeftClick 1
    Delay 1000
    
End Function
Function 分解装备
    // 写入Log
    If isLog = 0 Then 
        重启挂机 
        closeWindow
        installList ("打开背包：		" & Time)
        FindPic 791,613,1082,744,"C:\yhzr\背包.bmp",0.7,intX,intY
        If intX > 0 And intY > 0 Then 
            MoveTo intX, intY
            LeftClick 1
        End If
        Delay 1000
    End If
    isLog = 1
    FindPic 342,101,857,616,"C:\yhzr\蓝项链.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\蓝铠甲.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\蓝匕首.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If   
    FindPic 342,101,857,616,"C:\yhzr\蓝靴子.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If
    //
    FindPic 342,101,857,616,"C:\yhzr\紫项链.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\紫铠甲.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\紫匕首.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\紫靴子.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    //
    FindPic 342,101,857,616,"C:\yhzr\白靴子.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\白匕首.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\白铠甲.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\白项链.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY,0
    End If
    //
    FindPic 342,101,857,616,"C:\yhzr\金项链.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\金铠甲.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If
    FindPic 342,101,857,616,"C:\yhzr\金匕首.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If   
    FindPic 342,101,857,616,"C:\yhzr\金靴子.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,0
    End If
    //
    FindPic 342,101,857,616,"C:\yhzr\药1.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If
    FindPic 342,101,857,616,"C:\yhzr\药2.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If
    FindPic 342,101,857,616,"C:\yhzr\药3.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If   
    FindPic 342,101,857,616,"C:\yhzr\药4.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY,1
    End If
End Function
Function 分解(intX,intY,isClick)
    MoveTo intX+5, intY+5
    RightClick 1
    Delay 200
    MoveTo intX+7, intY+7
    LeftClick 1
    installList "分解成功：" & intX & "," & intY
    Delay 1000
End Function
Function 宠物召唤
    If  petType = 1 And petRun = 0 Then 
        召唤点击 38,648
    End If
    If  petType = 2 And petRun = 0 Then 
        召唤点击 85,648
    End If
    If  petType = 3 And petRun = 0 Then 
        召唤点击 36,701 
    End If
    If  petType = 4 And petRun = 0 Then 
        召唤点击 84,701 
    End If
    // 五分钟一召唤
    If 毫秒级时间戳 - petTime > 5 * 60 * 1000 Then 
        If  petType = 4 Then 
            petType = 1
        Else 
            petType = petType + 1
        End If
        petTime = 毫秒级时间戳
        petRun = 0
    End If
End Function
Function 召唤点击(x, y)
    MoveTo x,y
    LeftClick 2
    Delay 100
    petRun = 1
    installList "宠物召唤："& petType
End Function
//平A辅助
Function 平A 
    If 毫秒级时间戳 - ATime > 5000 Then 
        ATime = 毫秒级时间戳
        MoveTo 604, 347
        KeyPress "A", 1
        Delay 10
        LeftClick 1
        //installList "平A辅助"
    End If
End Function
//5分钟 未移动判断
Function 未移动判断
    GetColor = GetPixelColor(158, 128)
    If 毫秒级时间戳 - colorTime > 5 * 60 * 1000 Then 
        installList "当前颜色：" &GetPixelColor(158, 128)
        colorTime = 毫秒级时间戳
        If colorName =  GetColor Then 
            MoveTo 1114, 36
            RightClick 2
            installList "5分钟 未移动，开始移动"
            Delay 10000               
            colorName =  GetColor
        End If	
    End If
End Function
//死亡截图
Function Kill
    FindPic 260,107,1008,651,"C:\yhzr\kill.bmp",0.7,intX,intY
    If intX > 0 And intY > 0 Then 
        Call Lib.图像.无限屏幕截图(0,0,1366,768,"C:\英魂之刃kill\","bmp")
    End If
End Function
//关闭窗体
Function closeWindow
    installList ("关闭窗口：" & Time)
    //好友申请
    MoveTo 774, 245
    LeftClick 1
    Delay 200
    //分解失败
    MoveTo 729,315
    LeftClick 1
End Function
