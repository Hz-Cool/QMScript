[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=24988d2a-3f8c-42d0-8d4d-d81bb4b763b0
Description=副本v2
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]
1.图片资源是否移动
2.

[UIPackage]
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


[Script]
/**
每过3分钟 进行一次仓库分解
仓库分解时间为30秒每次
**/
Delay 1000
//捡箱子默认时间
Form1.InputBox1.Text = 180
//分解默认时间
Form1.InputBox2.Text = 30
缩小窗口
//初始时间记录
Dim times
times = 毫秒级时间戳
//当前的类型   1=捡宝箱  2=分解仓库(30秒)
Dim currType
currType = 2
//是否已经Log了 0=未Log 1=Log完成
Dim isLog
isLog = 0
//宠物相关 
//1=第一个宠物 2 3 4
Dim petType
petType = 1
//宠物在线时长 5分钟一召唤
Dim petTime
petTime = 毫秒级时间戳
// 宠物是否运行 0未运行 1已运行
Dim petRun
petRun = 0
// 平A地板时间
Dim ATime
ATime = 毫秒级时间戳
//颜色
Dim colorName
Dim colorTime
colorName = ""
colorTime = 毫秒级时间戳
//是否开启W   0开启  1关闭
Dim isW
isW = 0
While True
    If  currType = 1 Then 
        分解装备 
    End If
    If  currType = 2 Then 
        捡箱子 
    End If
    // 开始分解
    If  currType = 1 And 毫秒级时间戳 - times > Form1.InputBox2.Text * 1000  Then 
        currType = 2
        times = 毫秒级时间戳
        isLog = 0
    End If
    // 开始捡箱子
    If  currType = 2 And 毫秒级时间戳 - times > Form1.InputBox1.Text * 1000  Then 
        currType = 1
        times = 毫秒级时间戳
        isLog = 0
    End If
    宠物召唤 
    //5分钟未移动判断 
    //未移动判断 
    // 清理Log队列
    If  getListCount >20  Then 
        clearList
    End If
Wend
installList(getListCount)
//队首 插入
Function installList(text)
    Form1.ListBox1.InsertItem text,0 
End Function
//清理队列
Function clearList()
    Form1.ListBox1.List = "清理队列完成"
End Function
//队列长度 
Function getListCount()
    getListCount=  Form1.ListBox1.ListCount
End Function
Function 毫秒级时间戳()
    毫秒级时间戳=    (DateDiff("s","1970/1/1 00:00:00",Now())*1000)+(Round((timer() - Int(timer()))*1000,0))-T1
End Function
Function 时间戳转时间(时间戳)
    时间戳转时间=    DateAdd("s",时间戳,"1970/01/01 00:00:00")
End Function
Function 缩小窗口
    Hwnd = Plugin.Window.Find("COSCLIENT", "英魂之刃")//获取窗口句柄
    Call Plugin.Window.Move(Hwnd, 0, 0)//将句柄Hwnd的窗口移动到x,y
    Plugin.Window.SetClientSize Hwnd, 1200, 750//将句柄为Hwnd的窗口拉伸x,y
End Function
Function 捡箱子
    // 写入Log
    If isLog = 0 Then 
        closeWindow
        installList ("捡箱子：" & Time)
        //关闭背包
        MoveTo 828, 135
        LeftClick 1
        Delay 500
        重启挂机
    End If
    isLog = 1
    FindColorEx 219,129,937,618 ,"2CB1BB",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"7B625D",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"2B3E6C",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                If isW = 0
                    KeyPress "W", 1
                End If
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
    FindColorEx 219,129,937,618 ,"286D78",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"6E5C55",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"323E5A",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                If isW = 0
                    KeyPress "W", 1
                End If
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
    FindColorEx 219,129,937,618 ,"2A7C89",0,0.9,intX1,intY1
    If intX1 > 100 And intY1 > 100 Then 
        FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"6D5C55",0,0.9,intX2,intY2
        If intX2 > 100 And intY2 > 100 Then 
            FindColorEx intX1-10,intY1-10,intX1+10,intY1+10,"313C62",0,0.9,intX3,intY3
            If intX3 > 100 And intY3 > 100 Then 
                MoveTo intX1, intY1
                If isW = 0
                    KeyPress "W", 1
                End If
                LeftClick 2
                RightClick 2
            End If
        End If
    End If
End Function
Function 重启挂机
    installList ("重启挂机程序：" & Time)
    Delay 1500
    MoveTo 1141, 128
    LeftClick 1
    Delay 2000
    MoveTo 596,468
    LeftClick 1
    Delay 1000
    LeftClick 1
    Delay 1000
End Function
Function 分解装备
    // 写入Log
    If isLog = 0 Then 
        重启挂机
        closeWindow
        installList ("打开背包：		" & Time)
        FindPic 642,602,882,739,"C:\yhzr\背包.bmp",0.9,intX,intY
        If intX > 0 And intY > 0 Then 
            MoveTo intX, intY
            LeftClick 1
        End If
        Delay 1000
    End If
    isLog = 1
    FindPic 355,183,834,544,"C:\yhzr\蓝项链.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\蓝铠甲.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\蓝匕首.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If   
    FindPic 355,183,834,544,"C:\yhzr\蓝靴子.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    //
    FindPic 355,183,834,544,"C:\yhzr\紫项链.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\紫铠甲.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\紫匕首.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\紫靴子.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    //
    FindPic 355,183,834,544,"C:\yhzr\白靴子.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\白匕首.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\白铠甲.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\白项链.bmp",0.5,intX,intY
    If intX > 0 And intY > 0 Then 
        分解 intX,intY
    End If
    //
    FindPic 355,183,834,544,"C:\yhzr\金项链.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\金铠甲.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
    FindPic 355,183,834,544,"C:\yhzr\金匕首.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If   
    FindPic 355,183,834,544,"C:\yhzr\金靴子.bmp",0.5,intX,intY
    If intX > 0 And intX > 0 Then 
        分解 intX,intY
    End If
End Function
Function 分解(intX,intY)
    MoveTo intX+5, intY+5
    RightClick 1
    Delay 200
    MoveTo intX+7, intY+7
    LeftClick 1
    installList "分解成功："& intX &"," & intY
    Delay 1000
End Function
Function 宠物召唤
    If  petType = 1 And petRun = 0 Then 
        召唤点击 30, 681
    End If
    If  petType = 2 And petRun = 0 Then 
        召唤点击 56,676
    End If
    If  petType = 3 And petRun = 0 Then 
        召唤点击 25,712
    End If
    If  petType = 4 And petRun = 0 Then 
        召唤点击 55,715
    End If
    // 五分钟一召唤
    If 毫秒级时间戳 - petTime > 5 * 60 * 1000 Then 
        If  petType = 4 Then 
            petType = 1
        Else 
            petType = petType + 1
        End If
        petTime = 毫秒级时间戳
        petRun = 0
    End If
End Function
Function 召唤点击(x, y)
    MoveTo x,y
    LeftClick 2
    Delay 100
    petRun = 1
    installList "宠物召唤："& petType
End Function
//平A辅助
Function 平A 
    If 毫秒级时间戳 - ATime > 15000 Then 
        ATime = 毫秒级时间戳
        MoveTo 604, 347
        KeyPress "A", 1
        Delay 10
        LeftClick 1
        //installList "平A辅助"
    End If
End Function
//5分钟 未移动判断
Function 未移动判断
    GetColor = GetPixelColor(158, 128)
    If 毫秒级时间戳 - colorTime > 5 * 60 * 1000 Then 
        installList "当前颜色：" &GetPixelColor(158, 128)
        colorTime = 毫秒级时间戳
        If colorName =  GetColor Then 
            MoveTo 1114, 36
            RightClick 2
            installList "5分钟 未移动，开始移动"
            Delay 10000               
            colorName =  GetColor
        End If	
    End If
End Function
//死亡截图
Function Kill
    FindPic 260,107,1008,651,"C:\yhzr\kill.bmp",0.7,intX,intY
    If intX > 0 And intY > 0 Then 
        Call Lib.图像.无限屏幕截图(0,0,1366,768,"C:\英魂之刃kill\","bmp")
    End If
End Function
//关闭窗体
Function closeWindow
    installList ("关闭窗口：" & Time)
    //好友申请
    MoveTo 774, 245
    LeftClick 1
    Delay 200
    //分解失败
    MoveTo 729,315
    LeftClick 1
End Function
